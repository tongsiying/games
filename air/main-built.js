function addEvent(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e["e"+t+n]=n,e.attachEvent("on"+t,function(){e["e"+t+n]()}))}function removeEvent(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&(e.detachEvent("on"+t,e["e"+t+n]),e["e"+t+n]=null)}function getListener(e,t,n){var r;return t=t.toLowerCase(),(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}function removeItem(e,t){for(var n=0,r=e.length;n<r;n++)e[n]===t&&(e.splice(n,1),n--)}define("app/util/Event",function(){});var EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=e.trim().split(" ");for(var n=0,r;r=e[n++];)getListener(this,r,!0).push(t)},removeListener:function(e,t){e=e.trim().split(" ");for(var n=0,r;r=e[n++];)removeItem(getListener(this,r)||[],t)},fireEvent:function(){var e=arguments[0];e=e.trim().split(" ");for(var t=0,n;n=e[t++];){var r=getListener(this,n),i,s,o;if(r){o=r.length;while(o--){if(!r[o])continue;s=r[o].apply(this,arguments);if(s===!0)return s;s!==undefined&&(i=s)}}if(s=this["on"+n.toLowerCase()])i=s.apply(this,arguments)}return i}},define("app/util/EventBase",function(){});var util={domCollision:function(e,t){var n=e.offsetTop,r=e.offsetLeft,i=e.offsetLeft+e.offsetWidth,s=e.offsetTop+e.offsetHeight,o=t.offsetTop,u=t.offsetLeft,a=t.offsetLeft+t.offsetWidth,f=t.offsetTop+t.offsetHeight;return s<o||r>a||n>f||i<u?!1:!0},canvasCollision:function(e,t){return e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top?!1:!0},pointInRect:function(e,t,n,r,i,s){return n<e&&e<n+i&&t>r&&t<r+s?!0:!1},text:function(e,t,n,r,i){t.save(),t.font="40px Georgia",t.textBaseline="top",t.textAlign="center",t.fillText(i,n,r),t.save()},fnId:0,button:function(e,t,n,r,i,s){s=s||function(){},t.save(),t.font="20px Georgia",t.textBaseline="top",t.textAlign="center",t.strokeStyle="#2980B9",t.rect(n-40,r-8,80,40),t.stroke(),t.fillText(i,n,r),t.restore();var o=function(e){var t=e.pageX-this.offsetLeft,i=e.pageY-this.offsetTop;util.pointInRect(t,i,n-40,r-8,80,40)&&s&&s()};return util.addEv(e,"click",o),o},drawImage:function(e,t,n,r,i,s,o,u){u=u||function(){},t.save(),t.drawImage(n,r,i,s,o),t.restore();var a=function(e){var t=e.pageX-this.offsetLeft,n=e.pageY-this.offsetTop;util.pointInRect(t,n,r,i,s,o)&&u&&u()};return util.addEv(e,"click",a),a},addEv:function(e,t,n){e.addEventListener(t,n,!1)},removeEv:function(e,t,n){e.removeEventListener(t,n,!1)},clear:function(e){e.width=e.width,e.height=e.height}};define("app/util/global",function(){}),function(){var e=0,t=["webkit","moz"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),define("app/util/requestAnimationFrame",function(){}),define("app/Model/Audios",[],function(){window.fireEffect=new GT.Sound({id:"sfx-"+Math.random(),src:"./app/audio/fireEffect.mp3",loop:!1,volume:1,tag:"sfx"+Math.random(),channel:2}),fireEffect.load(),window.explodeEffect=new GT.Sound({id:"explodeEffect-2",src:"./app/audio/explodeEffect.mp3",loop:!1,volume:1,tag:"explodeEffect",channel:2}),explodeEffect.load(),window.diamonAudio=new GT.Sound({id:"Diamon-2",src:"./app/audio/Diamon.mp3",loop:!1,volume:1,tag:"Diamon",channel:2}),diamonAudio.load(),window.shipDestroyEffect=new GT.Sound({id:"sfx-2",src:"./app/audio/shipDestroyEffect.mp3",loop:!1,volume:1,tag:"sfx",channel:2}),shipDestroyEffect.load();var e=new GT.Sound({id:"sfx-1",src:"./app/audio/music.mp4",loop:!0,volume:1,tag:"sfx",channel:2});e.load(),e.onLoad=function(){this.play()}}),define("app/util/loadImgs",[],function(){return function(e,t,n,r){function u(){o--,n&&n((e.length-o)/e.length),o===0&&t&&t(i)}var i={};for(var s=0;s<e.length;s++)(function(t){var n=new Image;n.onload=function(){console.log(this.src),i[e[t]]=n,u&&u()},n.src=e[t],n.onerror=function(){console.log("图片加载失败"),r&&r()}})(s);var o=e.length;return i}}),define("app/C/TaskList",[],function(){var e=function(){this.list=[],this.timer=1};return e.tId=0,e.prototype.addTask=function(t){return t.tId=e.tId++,typeof t=="function"&&this.list.push(t),this},e.prototype.removeTask=function(e){var t=this.list.length;while(t--)(e===this.list[t]||e.tId===this.list[t].tId)&&this.list.splice(t,1)},e.prototype.run=function(){for(var e=0;e<this.list.length;e++)this.list[e]()},e.prototype.setInterval=function(e){e=e||33;var t=this;window.t=this;var n=function(){t.timer&&requestAnimationFrame(function(){t.run.bind(t)(),n()})};n()},e.prototype.clearInterval=function(){this.timer=0},e}),define("app/C/ExTaskList",["app/C/TaskList"],function(t){return $.extend(t.prototype,{plane:function(e){return e&&(this.plane=e),this},getPlaneMissiles:function(){return this.planeMissiles},addPlaneMissiles:function(e){return this.planeMissiles=this.planeMissiles||[],this.planeMissiles.push(e),this},removePlaneMissile:function(){if(_.contains(this.planeMissiles||[],e)){var t=this.planeMissiles.indexOf(e);return this.planeMissiles.splice(t,1),this}},getEnemy:function(){return this.enemys||[]},addEnemy:function(e){return this.enemys=this.enemys||[],this.enemys.push(e),this},removeEnemy:function(e){if(_.contains(this.enemys||[],e)){var t=this.enemys.indexOf(e);return this.enemys.splice(t,1),this}},getMissile:function(){return this.missiles},addMissile:function(e){return this.missiles=this.missiles||[],this.missiles.push(e),this},removeMissile:function(t){if(_.contains(this.missiles||[],e)){var n=this.missiles.indexOf(e);return this.missiles.splice(n,1),this}},getPowers:function(){return this.powers},addPower:function(e){return this.powers=this.powers||[],this.powers.push(e),this},removePower:function(e){if(_.contains(this.powers||[],e)){var t=this.powers.indexOf(e);return this.powers.splice(t,1),this}}}),t}),define("app/C/Page",[],function(){var e=P(EventBase,function(e){e.init=function(){},e.destory=function(){},e.create=function(){}});return e}),define("app/C/Pages",["app/C/Page"],function(e){var t=P(EventBase,function(t){var n=[],r=0;t.init=function(){},t.add=function(t){return t instanceof e?(n.length-1!==-1&&n[n.length-1].destory(),n.push(t),t.create(),this):(alert("参数错误"),this)},t.remove=function(e){var t;return(t=n.indexOf(e))!==-1&&n.splice(t,1),this},t.run=function(){return n.length>=2&&n[n.length-2].destory&&n[n.length-2].destory(),n[n.length-1].create&&n[n.length-1].create(),this},t.back=function(){var e=n.pop();return e.destory(),r=r-1>=0?r-1:0,n[r].create.apply(n[r],arguments),this},t.forward=function(){return n[r+1]&&r++,n[r].create().apply(n[r],arguments),this},t.start=function(){return typeof n[r]=="function"&&n[r].apply(n[r],arguments),this},t.clear=function(){return n=[],r=0,this}});return t}),define("app/G/Pages",["app/C/Page"],function(e){var t=P(e,function(e){var t,n,r;e.init=function(e){r=e},e.create=function(){var e=this;context.drawImage(window.gb.imgs["app/imgs/background1.jpg"],0,0,window.gb.imgs["app/imgs/background1.jpg"].width,window.gb.imgs["app/imgs/background1.jpg"].height,0,0,r.width,r.height),context.fillStyle="#ffffff",context.font="20px Arial",context.fillText("选择作战飞机",10,30),t=util.drawImage(r,context,window.gb.imgs["app/imgs/plane11.png"],r.width/2-40,r.height/2-100,80,80,function(){e.destory(),window.gb.initUserData("app/imgs/plane8.png"),window.gb.start()}),n=util.drawImage(r,context,window.gb.imgs["app/imgs/plane12.png"],r.width/2-40,r.height/2,80,80,function(){e.destory(),window.gb.initUserData("app/imgs/plane9.png"),window.gb.start()})},e.destory=function(){context.clearRect(0,0,r.width,r.height),util.removeEv(r,"click",t),util.removeEv(r,"click",n)}}),n=P(e,function(e){var t,n;e.init=function(e){n=e},e.create=function(){util.clear(n),context.fillStyle="#ffffff",context.drawImage(window.gb.imgs["app/imgs/g2.jpg"],0,0,n.width,n.height),context.font="30px Arial",context.fillText("help page",n.width/2,30),context.font="16px Arial",context.fillText("在电脑端通过方向键移动",0,n.height-60),context.fillText("在手机或者平板上直接触屏飞机可移动",0,n.height-30),t=util.button(n,context,60,10,"back",function(){pages.back()})},e.destory=function(){util.clear(n),util.removeEv(n,"click",t)}}),r=P(e,function(e){var t,n;e.init=function(e){n=e},e.create=function(){util.clear(n),context.drawImage(window.gb.imgs["app/imgs/author.png"],0,0,n.width,n.height),context.fillStyle="#ffffff",t=util.button(n,context,60,10,"back",function(){pages.back()}),context.font="20px Arial",context.fillText("Name page",n.width/2,20),context.fillText("author qihao",n.width/2,40),context.fillText("design qihao",n.width/2,60),context.fillText("music qihao",n.width/2,80),context.fillText("my blog : ",0,180),context.fillText("www.cnblogs.com/diligenceday",0,200)},e.destory=function(){util.clear(n),util.removeEv(n,"click",t)}}),i=P(e,function(e){var i,s,o,u,a=function(){pages.add(new t(i))},f=function(){pages.add(new n(i))},l=function(){pages.add(new r(i))};e.init=function(e){i=e},e.create=function(){util.clear(i),util.text(i,context,i.width/2,4,"info"),s=util.button(i,context,i.width/2,i.height/2-80,"start",a),o=util.button(i,context,i.width/2,i.height/2,"help",f),u=util.button(i,context,i.width/2,i.height/2+80,"names",l)},e.destory=function(){util.removeEv(i,"click",s),util.removeEv(i,"click",o),util.removeEv(i,"click",u),util.clear(i)}});return{SelectPage:t,HelpPage:n,NamePage:r,StartPage:i}}),define("app/C/Sprite",[],function(){var e=P(EventBase,function(e){e.init=function(e,t,n){this.date=Date.now(),this.now=0,this.bg=e,this.frames=t,this.time=n},e.calc=function(){return Date.now()-this.date>=this.time&&(this.now++,this.now>this.frames&&(this.now=0)),{bg:this.bg,now:this.now}},e.destory=function(){}});return e}),define("app/C/Bg",["app/C/Sprite"],function(e){var t=P(EventBase,function(t){var n,r,i,s,o;t.init=function(t,n,r){this.context=n,this.canvas=t,this.level=r||0,this.sprite=[new e(window.gb.imgs["app/imgs/back_img.png"],3051,30),new e(window.gb.imgs["app/imgs/back_img1.png"],1140,30),new e(window.gb.imgs["app/imgs/back_img2.png"],1140,30),new e(window.gb.imgs["app/imgs/back_img.png"],3051,30)][this.level],this.backgrond=this.sprite.calc().bg},t.setup=function(){this.now=this.sprite.calc().now},t.draw=function(){this.context.drawImage(this.backgrond,0,[3051,1640,1640,3551][this.level]-this.now-500,400,500,0,0,this.canvas.width,this.canvas.height)}});return t}),define("app/G/Info",[],function(){var e=P(EventBase,function(e){var t=0,n=0,r=0,i=0,s="",o,u;e.init=function(e,t){o=e,u=t},e.setup=function(e){t=e.score,n=e.money,r=e.blood,i=e.lifes,s=e.bg},e.draw=function(){u.save(),u.font="bold 10px serif",u.fillStyle="#f00",u.fillRect(10,2,3,9),u.fillRect(14,2,3,9),u.fillRect(18,2,3,9),u.fillStyle="#D35400",u.textBaseline="top",u.fillText("blood ： ",24,0),u.fillText(r,70,0),u.drawImage(window.gb.imgs["app/imgs/life.png"],0,0,10,10,10,22,10,9),u.fillText("lifes ： ",24,20),u.fillText(i,70,20),u.drawImage(window.gb.imgs["app/imgs/money.png"],0,0,10,10,10,42,10,9),u.fillStyle="#8E44AD",u.fillText("money ： ",24,40),u.fillText(n,70,40),u.drawImage(window.gb.imgs["app/imgs/power.png"],0,0,16,16,10,62,10,9),u.fillText("score ： ",24,60),u.fillText(t,70,60),u.restore()}});return e}),define("app/G/Plane",["app/C/Sprite"],function(e){var t=P(EventBase,function(t){t.init=function(t){this.opt=t,this.bg="",this.speed=1,this.blood=4,this.speedX=0,this.speedY=0,this.def=2;var n=this;n.imgData=[{name:window.gb.imgs["app/imgs/explosion1.png"],frames:6,w:43,h:41},{name:window.gb.imgs["app/imgs/explosion0.png"],frames:8,w:64,h:94},{name:window.gb.imgs["app/imgs/explosion2.png"],frames:7,w:50,h:50},{name:window.gb.imgs["app/imgs/explosion3.png"],frames:6,w:50,h:50},{name:window.gb.imgs["app/imgs/explosion4.png"],frames:14,w:82,h:68}][Math.floor(Math.random()*5)],this.detorySprite=new e(n.imgData.name,n.imgData.frames,140)},t.setup=function(){},t.draw=function(){},t.destory=function(){var e=this;shipDestroyEffect.play(),e.task.removeEnemy(e),e.task.addTask(function(){var t=e.detorySprite.calc().now;e.opt.context.drawImage(e.imgData.name,t*e.imgData.w,0,e.imgData.w,e.imgData.h,e.x,e.y-20,e.imgData.w,e.imgData.h),t===e.imgData.frames&&e.task.removeTask(arguments.callee)})},t.addScore=function(){this.money++}});return t}),define("app/G/Missile",["app/C/Sprite"],function(e){var t=P(EventBase,function(e){e.init=function(e,t,n,r,i,s,o,u){this.canvas=e,this.context=t,this.bg=n,this.x=r,this.y=i,this.speedX=u.speedX||0,this.speedY=u.speedY||-3,this.damage=u.damage||1,this.task=u.task||{},this.fn=u.fn,this.w=s,this.h=o},e.setup=function(){this.fn&&(this.speedX=this.fn(this.speedX)),this.x=this.x+this.speedX,this.y=this.y+this.speedY;var e=this.task.getEnemy();for(var t=0;t<e.length;t++)util.canvasCollision({left:this.x,top:this.y,right:this.x+this.w,bottom:this.y+this.h},{left:e[t].x,top:e[t].y,right:e[t].x+e[t].w,bottom:e[t].y+e[t].h})&&(e[t].blood--===0&&(window.gb.userData.score++,e[t].remove&&e[t].remove(),e[t].destory&&e[t].destory()),explodeEffect.play(),this.remove&&this.remove(),console.log("collision"))},e.draw=function(){this.context.drawImage(this.bg,this.x,this.y,this.w,this.h)},e.destory=function(){},e.outOfArea=function(){if(this.x<-this.w||this.x>this.canvas.width||this.y<-this.h||this.y>this.canvas.height)return!0}});return t}),define("app/util/CommonController",[],function(){var e=function(){this.timer=null};return e.prototype.run=function(e,t,n,r,i,s){return typeof document.ontouchstart=="object"?this.mobile.apply(this,arguments):this.PC.apply(this,arguments),this},e.prototype.PC=function(e,t,n,r,i){var s=this,o;addEvent(window,"keydown",function(u){clearInterval(s.timer);switch(u.keyCode){case 65:case 37:o=e;break;case 85:case 38:o=t;break;case 68:case 39:o=n;break;case 83:case 40:o=r}s.timer=setInterval(function(){o&&o(),i&&i()},10)}),addEvent(window,"keyup",function(){clearInterval(s.timer)})},e.prototype.mobile=function(e,t,n,r,i,s){var o=this,u=0,a=0,f,l,c=function(f){clearInterval(o.timer),u=f.touches&&f.touches[0].clientX,a=f.touches&&f.touches[0].clientY;var l=[];if(Math.abs(u-s.x)<s.dis&&Math.abs(a-s.y)<s.dis)return;u>s.x?l.push(n.bind(n,u,s.x,a)):l.push(e.bind(e,u,s.x,a)),a>s.y?l.push(r.bind(r,a,s.y,u)):l.push(t.bind(r,a,s.y,u)),o.timer=setInterval(function(){for(var e=0;e<l.length;e++)l[e].call(l[e],s.el);i&&i()},10)};addEvent(s.canvas,"touchstart",c),addEvent(s.canvas,"touchmove",c),addEvent(s.canvas,"touchend",function(e){clearInterval(o.timer)})},e}),define("app/G/MoonWarr",["app/G/Plane","app/G/Missile","app/C/Sprite","app/util/CommonController"],function(e,t,n,r){var i=P(e,function(e,i){e.init=function(e){e=e||{},i.init.apply(this,arguments),this.opt=e,this.task=e.task,this.y=e.canvas.height-40,this.x=(e.canvas.width-40)/2,this.canvas=e.canvas,this.w=40,this.h=40,this.dis=20,this.money=0,this.blood=10,this.lifes=4,this.speed=e.speed||2,this.equitsFlag=[!0,!0],this.equits=[{bg:"app/imgs/mybullet1.png",damage:1,speedX:0,speedY:-3,dx:2,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet1.png",damage:1,speedX:0,speedY:-3,dx:30,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet1.png",damage:1,speedX:-0.2,speedY:-3,dx:2,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet1.png",damage:1,speedX:.2,speedY:-3,dx:30,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet2.png",damage:1,speedX:-0.4,speedY:-4,dx:2,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet2.png",damage:1,speedX:.4,speedY:-4,dx:30,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet2.png",damage:1,speedX:-0.6,speedY:-4,dx:2,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet2.png",damage:1,speedX:.6,speedY:-4,dx:30,dy:-10,w:9,h:15},{bg:"app/imgs/mybullet3.png",damage:3,speedX:-0.3,speedY:-4,dx:4,dy:-20,w:10,h:14},{bg:"app/imgs/mybullet3.png",damage:3,speedX:.3,speedY:-4,dx:24,dy:-20,w:10,h:14},{bg:"app/imgs/hole.png",damage:3,speedX:0,speedY:-5,dx:4,dy:-20,w:30,h:30},{bg:"app/imgs/bomb.png",damage:4,speedX:-0.5,speedY:-2,dx:0,dy:-20,w:20,h:20,fn:function(){var e=1,t=.01;return function(n){if(e===1)return n-t;e=-e}}()},{bg:"app/imgs/bomb.png",damage:4,speedX:.5,speedY:-2,dx:36,dy:-20,w:20,h:20,fn:function(){var e=1,t=.01;return function(n){if(e===1)return n+t;e=-e}}()}],this.bg=e.bg,this.sprite=new n(this.bg,window.gb.userData.frames,400),this.bindEv(),this.missileSprite=new n("testData",16,400)},e.setup=function(){if(this.missileSprite.calc().now===1){var e=this;for(var n=0;n<this.equits.length;n++)if(this.equitsFlag[n]){var r=this.equits[n];(function(){var n=new t(this.opt.canvas,this.opt.canvas.getContext("2d"),window.gb.imgs[r.bg],this.x+r.dx,this.y+r.dy,r.w,r.h,{speedX:r.speedX,speedY:r.speedY,damage:r.damage,fn:r.fn,task:e.task}),i=function(){n.setup(),n.draw(),n.outOfArea()&&(n.destory(),e.task.removeTask(arguments.callee))};n.remove=function(){e.task.removeTask(i)},e.task.addTask(i)}).call(this)}fireEffect.play()}},e.draw=function(){var e=this.sprite.calc().now;this.opt.context.drawImage(this.opt.bg,e*78,0,78,85,this.x,this.y,this.w,this.h)},e.raiden=function(){var e=this.draw,t=this,n=Date.now(),r=11,i=0;this.draw=function(){e.apply(t,arguments),Date.now()-n>4e3/11&&(i++,n=Date.now()),t.opt.context.drawImage(window.gb.imgs["app/imgs/flash.png"],i*t.w,0,100,100,t.x,t.y,t.w,t.h)},setTimeout(function(){t.draw=e},4e3)},e.red=function(){var e=this.draw,t=this;this.draw=function(){t.opt.context.fillStyle="#f00",t.opt.context.globalCompositeOperation="lighter",t.opt.context.fillRect(t.x,t.y,t.w,t.h),e.apply(t,arguments)},setTimeout(function(){t.draw=e},4e3)},e.flash=function(){var e=this.draw,t=this;this.draw=function(){var n=Math.random();t.opt.context.fillStyle="rgba(255, 255, 255, "+n+")",n>.3&&e.apply(t,arguments)},setTimeout(function(){t.draw=e},4e3)};var s=[];e.equits=function(){[].splice.call(arguments,0,0,this.x,this.y,this.width,this.height);for(var e=0,t=s.length;e<t;e++)s[e].apply(this,arguments)},e.addEquit=function(e){return s.push(e),this},e.removeEquit=function(e){var t=s.indexOf(e);return t!==-1&&s.splice(t,1),this},e.drawDashLine=function(){var e=function(){Math.random()*10>6&&(this.opt.context.save(),this.opt.context.beginPath(),this.opt.context.setLineDash([5]),this.opt.context.strokeStyle="#EEEEEE",this.opt.context.arc(arguments[0],arguments[1],arguments[2],0,2*Math.PI,!0),this.opt.context.stroke(),this.opt.context.restore())}.bind(this),t=this;this.addEquit(e),setTimeout(function(){t.removeEquit(e)},4e3)},e.setLeft=function(t){e.x=t},e.setTop=function(t){e.y=t},e.bindEv=function(){var e=this,t=new r;t.run(function(t,n,r){var i=Math.abs((n-t)*e.speed/Math.pow((n-t)*(n-t)+(e.y-r)*(e.y-r),.5));isNaN(i)&&(i=e.speed),e.x-=i,e.x<0&&(e.x=0),e.x<t&&(e.x=t),e.x+e.w>e.canvas.width&&(e.x=e.canvas.width-e.w)},function(t,n,r){var i=Math.abs((n-t)*e.speed/Math.pow((n-t)*(n-t)+(r-e.x)*(r-e.x),.5));isNaN(i)&&(i=e.speed),e.y-=i,e.y<0&&(e.y=0),e.y<t&&(e.y=t)},function(t,n,r){var i=Math.abs((n-t)*e.speed/Math.pow((n-t)*(n-t)+(e.y-r)*(e.y-r),.5));isNaN(i)&&(i=e.speed),e.x+=i,e.x>t&&(e.x=t),e.x>canvas.width-e.w&&(e.x=canvas.width-e.h)},function(t,n,r){var i=Math.abs((n-t)*e.speed/Math.pow((n-t)*(n-t)+(r-e.x)*(r-e.x),.5));isNaN(i)&&(i=e.speed),e.y+=i,e.y>t&&(e.y=t),e.y>canvas.height-e.h&&(e.y=canvas.height-e.h)},function(){},e)},e.remove=function(){this.blood=10,this.lifes--,this.lifes===-1&&($.dialog({content:"游戏失败",title:"提示信息",ok:function(){location.reload()},cancel:function(){location.reload()},lock:!0}),this.task.clearInterval()),this.flash()},e.judge=function(){this.blood--,this.destory&&this.destory(),this.blood--<=0&&this.remove&&this.remove()}});return i}),define("app/C/Progress",["app/util/loadImgs"],function(e){var t=P(EventBase,function(t){t.init=function(){},t.load=function(t,n){var r=this,i=e(t,function(){r.fireEvent("done",i)},function(e){r.fireEvent("load",e)})}});return t}),define("app/C/loadGImgsModule",["app/C/Progress"],function(e){var t=function(t,n,r){var i=new e;i.addListener("done",function(e,n){util.clear(t),window.gb&&(window.gb.imgs=n),console.log("done"),r&&r()}),i.addListener("load",function(e,r){n.save(),n.fillStyle="#ECF0F1",n.fillRect(0,0,r*t.width,t.height),n.fillStyle="#7F8C8D",n.fillText(parseInt(r*100)+"%",100,100),n.restore()}),i.load(window.gb.users)};return t}),define("app/G/EMissile",["app/G/Missile","app/C/Sprite"],function(e,t){var n=P(e,function(e,t){e.init=function(){t.init.apply(this,arguments)},e.setup=function(){this.x=this.x+this.speedX,this.y=this.y+this.speedY;var e=this.task.plane;util.canvasCollision({left:this.x,top:this.y,right:this.x+this.w,bottom:this.y+this.h},{left:e.x,top:e.y,right:e.x+e.h,bottom:e.y+e.w})&&(e.judge(),explodeEffect.play(),this.remove&&this.remove(),console.log("collision"))}}),r=P(e,function(e,t){e.init=function(){t.init.call(this,arguments)}});return n}),define("app/G/Diamon",["app/C/Sprite"],function(e){var t=P(EventBase,function(t){t.init=function(t){var n=this;this.x=t.x||0,this.y=t.y||0,this.w=t.w||10,this.h=t.h||10,this.canvas=t.canvas||canvas,this.context=t.context||context,this.speedX=t.speedX||1,this.speedY=t.speedY||1,this.task=t.task||{},this.bg=window.gb.imgs[["app/imgs/diamons/d0.png","app/imgs/diamons/d1.png","app/imgs/diamons/d2.png","app/imgs/diamons/d3.png","app/imgs/diamons/d4.png"][_.random(0,4)]],this.sprite=new e("testData",16,10),this.taskFn=function(){n.setup(),n.draw()},this.task.addTask(this.taskFn),this.removeTask=function(){this.task.removeTask(this.taskFn)}},t.setup=function(){var e=this;this.x+=this.speedX,this.y+=this.speedY;var t=this.task.plane;if(util.canvasCollision({left:this.x,top:this.y,right:this.x+this.w,bottom:this.y+this.h},{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})){diamonAudio.play(),e.removeTask(),t.addScore();return}(e.x<-e.w||e.x>e.canvas.width||e.y<-e.h||e.y>e.canvas.height)&&e.removeTask()},t.draw=function(){this.context.drawImage(this.bg,0,0,65,65,this.x,this.y,this.w,this.h)}});return t}),define("app/G/Power",["app/G/Diamon","app/C/Sprite"],function(e,t){var n=[{img:"app/imgs/addbomb.png"},{img:"app/imgs/addlife.png"},{img:"app/imgs/addhealth.png"},{img:"app/imgs/addpower.png"},{img:"app/imgs/speed.png"}],r=new GT.Sound({id:"Diamon-3",src:"./app/audio/Diamon.mp3",loop:!1,volume:1,tag:"Diamon3",channel:2}),i=P(e,function(e,i){e.init=function(e){var r=this;this.x=e.x||0,this.y=e.y||0,this.w=e.w||10,this.h=e.h||10,this.canvas=e.canvas||canvas,this.context=e.context||context,this.speedX=e.speedX||1,this.speedY=e.speedY||1,this.task=e.task||{};var i=_.random(0,4);this.type=i;var s=n[i];this.bg=window.gb.imgs[s.img],this.w=40,this.h=40,this.sprite=new t("testData",16,10),this.taskFn=function(){r.setup(),r.draw()},this.task.addTask(this.taskFn),this.removeTask=function(){this.task.removeTask(this.taskFn)}},e.setup=function(){var e=this;this.x+=this.speedX,this.y+=this.speedY;var t=this.task.plane;if(util.canvasCollision({left:this.x,top:this.y,right:this.x+this.w,bottom:this.y+this.h},{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})){r.play(),e.removeTask(),this.type==4&&t.speed++,this.type===3&&(t.equitsFlag.push(!0),t.equitsFlag.push(!0)),this.type===2&&t.blood++,this.type===1&&t.lifes++,this.type===0&&t.raiden();return}(e.x<-e.w||e.x>e.canvas.width||e.y<-e.h||e.y>e.canvas.height)&&e.removeTask()}});return i}),define("app/G/Enemy",["app/G/Plane","app/G/EMissile","app/C/Sprite","app/G/Diamon","app/G/Power"],function(e,t,n,r,i){var s=P(e,function(e,s){e.init=function(e){var o=this;s.init.apply(this,arguments),this.opt=e||{},this.canvas=e.canvas,this.context=e.context,this.task=e.task,this.EMissile=e.EMissile||t,this.eMissileBg=e.eMissileBg||window.gb.imgs["app/imgs/enemybullet1.png"],this.eMissileW=e.eMissileW||8,this.eMissileH=e.eMissileH||8,this.eMissileSpeedX=e.eMissileSpeedX||0,this.eMissileSpeedY=e.eMissileSpeedY||3,this.eMissileDamage=e.eMissileDamage||1,this.bg=e.bg||window.gb.imgs["app/imgs/enemy0.png"],this.money=e.money||1,this.task=e.task,this.x=e.x||0,this.y=e.y||0,this.speedX=typeof e.speedX=="number"?e.speedX:1,this.speedY=e.speedY||1,this.w=e.w||40,this.h=e.h||40,this.blood=e.blood||2,this.speed=e.speed||2,this.sprite=new n("testData",20,500);var u=function(){o.setup(),o.draw(),(o.x<-o.w||o.x>o.canvas.width||o.y<-o.h||o.y>o.canvas.height)&&o.task.removeTask(arguments.callee)};this.task.addTask(u),this.remove=function(){if(_.random(0,10)>4)var e=new r({task:o.task,canvas:o.canvas,context:o.context,x:o.x,y:o.y,w:20,h:20,speedX:o.speedX/2,speedY:o.speedY/2});_.random(0,10)>7&&new i({task:o.task,canvas:o.canvas,context:o.context,x:o.x,y:o.y,speedX:o.speedX/2,speedY:o.speedY/2}),o.task.removeTask(u)}},e.setup=function(){var e=this;this.x+=this.speedX,this.y+=this.speedY;if(this.sprite.calc().now==4){var t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w/2,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n)}var r=this.task.plane;util.canvasCollision({left:this.x,top:this.y,right:this.x+this.w,bottom:this.y+this.h},{left:r.x,top:r.y,right:r.x+r.w,bottom:r.y+r.h})&&(this.blood--===0&&(window.gb.userData.score++,this.remove&&this.remove(),this.destory&&this.destory()),r.judge(),explodeEffect.play())},e.draw=function(){this.context.drawImage(this.bg,this.x,this.y,this.w,this.h)}});return s}),define("app/G/Boss",["app/G/Plane","app/G/EMissile","app/C/Sprite"],function(e,t,n){var r=P(e,function(e,r){e.init=function(e){var i=this;r.init.apply(this,arguments),this.opt=e||{},this.canvas=e.canvas,this.context=e.context,this.task=e.task,this.EMissile=e.EMissile||t,this.eMissileBg=e.eMissileBg||window.gb.imgs["app/imgs/enemybullet1.png"],this.eMissileW=e.eMissileW||8,this.eMissileH=e.eMissileH||8,this.eMissileSpeedX=e.eMissileSpeedX||0,this.eMissileSpeedY=e.eMissileSpeedY||3,this.eMissileDamage=e.eMissileDamage||1,this.bg=e.bg||window.gb.imgs["app/imgs/enmey0.png"],this.money=e.money||1,this.task=e.task,this.x=e.x||0,this.y=e.y||0,this.speedX=typeof e.speedX=="number"?e.speedX:1,this.speedY=e.speedY||1,this.w=e.w||40,this.h=e.h||40,this.blood=e.blood||2,this.speed=e.speed||2,this.sprite=new n("testData",20,500);var s=function(){i.setup(),i.draw()};this.task.addTask(s),this.remove=function(){i.task.removeTask(s)}},e.setup=function(){},e.draw=function(){this.context.drawImage(this.bg,this.x,this.y,this.w,this.h)},e.destory=function(){var e=this;r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),setTimeout(function(){r.destory.apply(e,arguments),window.gb.level++,$.dialog({content:"游戏成功, 进入下一关!",title:"alert",ok:function(){g(window.gb.level)},cancel:function(){location.reload()},lock:!0})},1e3)},1e3)},1e3)},1e3)},1e3)},1e3)},1e3)},1e3)}});return r}),define("app/G/Boss0",["app/G/Boss"],function(e){var t=P(e,function(e,t){e.init=function(){var e=this;t.init.apply(this,arguments),setTimeout(function(){e.speedY=0},2e3),setTimeout(function(){e.shot=e.shot2},3e3),setTimeout(function(){e.shot=e.shot3},6e3)},e.setup=function(){var e=this;this.x+=this.speedX,this.y+=this.speedY;if(this.y)var t=this.sprite.calc().now;t==4&&this.shot(),t==20&&(e.speedX==0?e.speedX=2:e.speedX=-e.speedX)},e.shot=function(){this.shot1()},e.shot1=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w/2-this.eMissileW/2,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n)},e.shot2=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n);var r=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),i=function(){r.setup(),r.draw(),r.outOfArea()&&(r.destory(),e.task.removeTask(arguments.callee))};r.remove=function(){e.task.removeTask(i)},e.task.addTask(i)},e.shot3=function(){this.shot1(),this.shot2()},e.destory=function(){t.destory.apply(this,arguments)}});return t}),define("app/G/Boss1",["app/G/Boss"],function(e){var t=P(e,function(e,t){e.init=function(e){var n=this;t.init.apply(this,arguments),this.eMissileBg=e.eMissileBg||window.gb.imgs["app/imgs/pd30.png"],this.bg=e.bg||window.gb.imgs["app/imgs/boss0.png"],setTimeout(function(){n.shot=n.shot2},3e3),setTimeout(function(){n.shot=n.shot3},6e3)},e.setup=function(){var e=this;this.y>300&&(this.speedY=-this.speedY),this.y<0&&(this.speedY=Math.abs(this.speedY));if(this.x<0||this.x>this.canvas.width-this.w)this.speedX=-this.speedX;this.x+=this.speedX,this.y+=this.speedY;var t=this.sprite.calc().now;t==4&&this.shot()},e.shot=function(){this.shot1()},e.shot1=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w/2-this.eMissileW/2,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n)},e.shot2=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n);var r=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),i=function(){r.setup(),r.draw(),r.outOfArea()&&(r.destory(),e.task.removeTask(arguments.callee))};r.remove=function(){e.task.removeTask(i)},e.task.addTask(i)},e.shot3=function(){this.shot1(),this.shot2()},e.destory=function(){t.destory.apply(this,arguments)}});return t}),define("app/G/Boss2",["app/G/Boss"],function(e){var t=P(e,function(e,t){e.init=function(e){var n=this;t.init.apply(this,arguments),this.eMissileBg=e.eMissileBg||window.gb.imgs["app/imgs/pd30.png"],this.bg=e.bg||window.gb.imgs["app/imgs/boss0.png"],setTimeout(function(){n.shot=n.shot2},3e3),setTimeout(function(){n.shot=n.shot3},6e3)},e.setup=function(){var e=this;this.y>300&&(this.speedY=-this.speedY),this.y<0&&(this.speedY=Math.abs(this.speedY));if(this.x<0||this.x>this.canvas.width-this.w)this.speedX=-this.speedX;this.x+=this.speedX,this.y+=this.speedY;var t=this.sprite.calc().now;t==4&&this.shot()},e.shot=function(){this.shot1()},e.shot1=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w/2-this.eMissileW/2,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n)},e.shot2=function(){var e=this,t=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),n=function(){t.setup(),t.draw(),t.outOfArea()&&(t.destory(),e.task.removeTask(arguments.callee))};t.remove=function(){e.task.removeTask(n)},e.task.addTask(n);var r=new this.EMissile(this.canvas,this.context,this.eMissileBg,this.x+this.w,this.y,this.eMissileW,this.eMissileH,{speedX:this.eMissileSpeedX,speedY:this.eMissileSpeedY,damage:this.eMissileDamage,task:this.task}),i=function(){r.setup(),r.draw(),r.outOfArea()&&(r.destory(),e.task.removeTask(arguments.callee))};r.remove=function(){e.task.removeTask(i)},e.task.addTask(i)},e.shot3=function(){this.shot1(),this.shot2()},e.destory=function(){$.dialog({content:"恭喜闯关成功， 谢谢您的支持",title:"提示信息",ok:function(){location.reload()},cancel:function(){location.reload()},lock:!0}),this.task.clearInterval()}});return t}),define("app/Model/Levels",["app/G/Enemy","app/G/EMissile","app/G/Boss","app/G/Boss0","app/G/Boss1","app/G/Boss2"],function(e,t,n,r,i,s){return function(n){function u(e,t,n,r){for(var i=parseInt(t);i<parseInt(n);i+=1e3)typeof e[i]=="object"?e[i].push(r[0]):e[i]=r}var o={0:{},1:{},2:{},3:{}};for(var a=0;a<200;a++){var f=[-10,n.width-10][_.random(0,1)],l=_.random(-20,100),c=f<0?[1,2,3,4,5,6][_.random(0,6)]:[-1,-2,-3,-5,-4][_.random(0,5)],h=[1,2,3,4,5][_.random(0,4)];o[0][parseInt(Math.floor(Math.random()*200)+"000")]=[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs[["app/imgs/enemy0.png","app/imgs/enemy1.png","app/imgs/enemy2.png","app/imgs/enemy3.png","app/imgs/enemy4.png","app/imgs/enemy5.png"][_.random(0,6)]],w:40,h:40,x:f,y:l,speedX:c,speedY:h,blood:2,eMissileSpeedX:c+2,eMissileSpeedY:h+2,eMissileBg:window.gb.imgs[["app/imgs/enemybullet1.png","app/imgs/enemybullet.png","app/imgs/blastz1.png","app/imgs/blastz2.png","app/imgs/blastz3.png","app/imgs/blastz4.png","app/imgs/blastz5.png","app/imgs/blastz6.png"][_.random(.7)]],EMissile:t,eMissileH:8,eMissileW:8,eMissileDamage:1}]]}u(o[0],1e3,4e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy0.png"],w:40,h:40,x:0,y:0,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],7e3,11e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy1.png"],w:40,h:40,x:0,y:100,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],12e3,18e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy1.png"],w:40,h:40,x:n.width/2,y:-10,speedX:0,speedY:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:-3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],2e4,26e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy3.png"],w:40,h:40,x:0,y:n.width-1,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],3e4,36e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy4.png"],w:40,h:40,x:1,y:n.width-1,speedX:0,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],37e3,4e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy5.png"],w:40,h:40,x:n.width-1,y:0,speedX:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:2,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],41e3,5e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy2.png"],w:50,h:50,x:n.width-1,y:100,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],5e4,55e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy5.png"],w:50,h:50,x:n.width-1,y:0,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[0],55e3,6e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy4.png"],w:50,h:50,x:n.width-1,y:0,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),o[0][21e4]=[[r,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/boss.png"],w:176,h:80,x:(n.width-176)/2,y:-79,speedX:0,speedY:1,blood:200,eMissileSpeedX:0,eMissileSpeedY:4,eMissileBg:window.gb.imgs["app/imgs/bossbullet2.png"],EMissile:t,eMissileH:41,eMissileW:16,eMissileDamage:1}]];for(var a=0;a<400;a++){var f=[-10,n.width-10][_.random(0,1)],l=_.random(-20,100),c=f<0?[1,2,3,4,5,6][_.random(0,5)]:[-1,-2,-3,-5,-4][_.random(0,5)],h=[1,2,3,4,5][_.random(0,4)];o[1][parseInt(Math.floor(Math.random()*200)+"000")]=[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs[["app/imgs/enemy6.png","app/imgs/enemy7.png","app/imgs/enemy8.png","app/imgs/enemy9.png"][_.random(0,3)]],w:40,h:40,x:f,y:l,speedX:c,speedY:h,blood:2,eMissileSpeedX:c+2,eMissileSpeedY:h+2,eMissileBg:window.gb.imgs[["app/imgs/enemybullet1.png","app/imgs/enemybullet.png","app/imgs/blastz1.png","app/imgs/blastz2.png","app/imgs/blastz3.png","app/imgs/blastz4.png","app/imgs/blastz5.png","app/imgs/blastz6.png"][_.random(.7)]],EMissile:t,eMissileH:8,eMissileW:8,eMissileDamage:1}]]}u(o[1],1e3,4e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy5.png"],w:40,h:40,x:0,y:0,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],7e3,11e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy6.png"],w:40,h:40,x:0,y:100,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],12e3,18e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy7.png"],w:40,h:40,x:n.width/2,y:-10,speedX:0,speedY:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:-3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],2e4,26e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy8.png"],w:40,h:40,x:0,y:n.width-1,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],3e4,36e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy9.png"],w:40,h:40,x:1,y:n.width-1,speedX:0,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],37e3,4e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy6.png"],w:40,h:40,x:n.width-1,y:0,speedX:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:2,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],41e3,5e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy8.png"],w:50,h:50,x:n.width-1,y:100,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],5e4,55e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy9.png"],w:50,h:50,x:n.width-1,y:0,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[1],55e3,6e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy7.png"],w:50,h:50,x:n.width-1,y:0,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),o[1][21e4]=[[i,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/boss0.png"],w:176,h:80,x:(n.width-176)/2,y:-30,speedX:1,speedY:2,blood:400,eMissileSpeedX:0,eMissileSpeedY:4,eMissileBg:window.gb.imgs["app/imgs/pd30.png"],EMissile:t,eMissileH:41,eMissileW:16,eMissileDamage:1}]];for(var a=0;a<500;a++){var f=[-10,n.width-10][_.random(0,1)],l=_.random(-20,100),c=f<0?[1,2,3,4,5,6][_.random(0,5)]:[-1,-2,-3,-5,-4][_.random(0,5)],h=[1,2,3,4,5][_.random(0,4)];o[2][parseInt(Math.floor(Math.random()*200)+"000")]=[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs[["app/imgs/enemy0.png","app/imgs/enemy4.png","app/imgs/enemy6.png","app/imgs/enemy8.png","app/imgs/enemy9.png"][_.random(0,4)]],w:60,h:60,x:f,y:l,speedX:c,speedY:h,blood:2,eMissileSpeedX:c+2,eMissileSpeedY:h+2,eMissileBg:window.gb.imgs[["app/imgs/enemybullet1.png","app/imgs/enemybullet.png","app/imgs/blastz1.png","app/imgs/blastz2.png","app/imgs/blastz3.png","app/imgs/blastz4.png","app/imgs/blastz5.png","app/imgs/blastz6.png"][_.random(.7)]],EMissile:t,eMissileH:8,eMissileW:8,eMissileDamage:1}]]}return u(o[2],1e3,4e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy0.png"],w:60,h:60,x:0,y:0,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],7e3,11e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy8.png"],w:60,h:60,x:0,y:100,speedX:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],12e3,18e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy9.png"],w:60,h:60,x:n.width/2,y:-10,speedX:0,speedY:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:-3,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],2e4,26e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy0.png"],w:60,h:60,x:0,y:n.width-1,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/enemybullet1.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],31e3,36e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy9.png"],w:60,h:60,x:10,y:-40,speedX:0,speedY:3,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],37e3,4e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy8.png"],w:60,h:60,x:n.width/2,y:-10,speedX:0,speedY:2,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:2,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],38e3,5e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy8.png"],w:60,h:60,x:n.width-1,y:-40,speedX:-1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],5e4,55e3,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy9.png"],w:60,h:60,x:n.width-1,y:0,speedX:-1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),u(o[2],55e3,6e4,[[e,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/enemy7.png"],w:60,h:60,x:-10,y:-10,speedX:1,speedX:1,EMissile:t,eMissileBg:window.gb.imgs["app/imgs/blastz3.png"],eMissileH:8,eMissileW:8,eMissileSpeedX:0,eMissileSpeedY:5,eMissileDamage:1}]]),o[2][21e4]=[[s,{canvas:n,context:n.getContext("2d"),bg:window.gb.imgs["app/imgs/boss3.png"],w:149,h:193,x:(n.width-176)/2,y:-30,speedX:1,speedY:2,blood:400,eMissileSpeedX:0,eMissileSpeedY:4,eMissileBg:window.gb.imgs["app/imgs/pd30.png"],EMissile:t,eMissileH:41,eMissileW:16,eMissileDamage:1}]],o}});var cfg=cfg||{};window.gb=window.gb||{users:["app/imgs/background1.jpg","app/imgs/plane11.png","app/imgs/plane12.png","app/imgs/logo_aliyun.jpg","app/imgs/plane8.png","app/imgs/plane9.png","app/imgs/back_img.png","app/imgs/back_img1.png","app/imgs/back_img2.png","app/imgs/flash.png","app/imgs/life.png","app/imgs/money.png","app/imgs/power.png","app/imgs/speed.png","app/imgs/mybullet1.png","app/imgs/mybullet2.png","app/imgs/mybullet3.png","app/imgs/enemy0.png","app/imgs/enemy1.png","app/imgs/enemy2.png","app/imgs/enemy3.png","app/imgs/enemy4.png","app/imgs/enemy5.png","app/imgs/enemy6.png","app/imgs/enemy7.png","app/imgs/enemy8.png","app/imgs/enemy9.png","app/imgs/enemybullet1.png","app/imgs/enemybullet.png","app/imgs/blastz1.png","app/imgs/blastz2.png","app/imgs/blastz3.png","app/imgs/blastz4.png","app/imgs/blastz5.png","app/imgs/blastz6.png","app/imgs/hole.png","app/imgs/bomb.png","app/imgs/explosion0.png","app/imgs/explosion1.png","app/imgs/explosion2.png","app/imgs/explosion3.png","app/imgs/explosion4.png","app/imgs/diamons/d0.png","app/imgs/diamons/d1.png","app/imgs/diamons/d2.png","app/imgs/diamons/d3.png","app/imgs/diamons/d4.png","app/imgs/addbomb.png","app/imgs/addlife.png","app/imgs/addhealth.png","app/imgs/addpower.png","app/imgs/boss.png","app/imgs/boss0.png","app/imgs/boss4.png","app/imgs/bossbullet2.png","app/imgs/pd30.png","app/imgs/g2.jpg","app/imgs/author.png"],initUserData:function(e){e=e||"app/imgs/s.gif",gb.userData={"app/imgs/plane8.png":{blood:10,lifes:4,speed:1,score:0,money:0,bg:"app/imgs/plane8.png",frames:2,superBomb:2},"app/imgs/plane9.png":{blood:10,lifes:4,speed:1,score:0,money:0,bg:"app/imgs/plane9.png",frames:0,superBomb:2},"app/imgs/logo_aliyun.jpg":{blood:10,lifes:4,speed:1,score:0,frames:0,money:0,bg:"app/imgs/logo_aliyun.jpg",superBomb:2}}[e]},userData:{blood:10,lifes:4,speed:1,score:0,frames:3,money:0,bg:"app/imgs/plane8.png"}},require(["app/util/Event","app/util/EventBase","app/util/global","app/util/requestAnimationFrame","app/Model/Audios"],function(){}),require(["app/util/loadImgs","app/C/ExTaskList","app/C/Pages","app/G/Pages","app/C/Page","app/C/Bg","app/G/Info","app/G/MoonWarr","app/C/loadGImgsModule","app/Model/Levels","app/G/Diamon"],function(e,t,n,r,i,s,o,u,a,f,l){window.canvas=document.getElementsByTagName("canvas")[0],window.context=canvas.getContext("2d"),window.g=function(e){var n=f(canvas);window.gb.level=e||0;var r=Date.now(),i=new t,a=new u({bg:window.gb.imgs[window.gb.userData.bg],canvas:canvas,context:canvas.getContext("2d"),task:i}),l=new s(canvas,canvas.getContext("2d"),window.gb.level+1);a.flash();var c=new o(canvas,context);i.plane(a),a.drawDashLine();var h=function(){a.setup.bind(a)(),a.draw.bind(a)()};i.addTask(function(){util.clear(canvas)}).addTask(function(){l.setup(),l.draw()}).addTask(function(){window.gb.userData.money=a.money,window.gb.userData.blood=a.blood,window.gb.userData.lifes=a.lifes,c.setup(window.gb.userData)}).addTask(function(){c.draw.bind(c)()}).addTask(h).addTask(function(){var e=Date.now()-r,t=(e+"").replace(/\d{3,3}$/,"000"),s=n[window.gb.level][t];if(s){for(var o=0;o<s.length;o++){var u=s[o];u[1].task=i;var a=new u[0](u[1]);i.addEnemy(a)}delete n[window.gb.level][t]}}).setInterval(30)},window.gb.start=function(){g()},a(canvas,context,function(){var e=!1;e?g(0):(window.pages=new n,pages.add(new r.StartPage(canvas)),pages.start())})}),define("app/main",function(){}),requirejs.config({baseUrl:"libs",paths:{app:"../app"}}),requirejs(["app/main"],function(){console.log("start"),window.oncontextmenu=function(){return!1}}),define("app",function(){});